# Emerging-DoH-Tunnel-Traffic-XTU dataset

- The dataset (`Emerging-DoH-Tunnel-Traffic-XTU.zip`) is available via [Google Drive download link](https://drive.google.com/file/d/1LVEKM757Z7LV9zTgeydeYxnRrilLFFQh/view?usp=drive_link)

- The dataset contains PCAP files of DoH tunnel traffic generated by tuns<sup>[1]</sup>,tcp-over-dns<sup>[2]</sup>,dnstt<sup>[3]</sup>,godoh<sup>[4]</sup> and DNSExfiltrator<sup>[5]</sup>.

- The dataset contains DoH traffic generated by the SafeDoHCapture<sup>[7]</sup> tool manipulating Chrome and Firefox browsers.

- The captured raw PCAP files are segmented by pcapSpliter<sup>[8]</sup> which using an algorithm consistent with DoHlyzer.

# License

- If you use the dataset, please be sure to cite the following paper.

```
[references]
```

# Network connections and capturing point

![network](https://github.com/XTU-TunnelVision/Emerging-DoH-Tunnel-Traffic-XTU/raw/master/NetFlow.png)

- All tunnel tools ultimately connect to a suspicious DNS server.

- dnstt, godoh, and DNSExfiltrator establish direct connections to a DoH server as they natively support the DoH protocol.

- Meanwhile, tcp-over-dns and tuns rely on a DoH proxy to convert conventional DNS traffic into DoH.

- We use CoreDNS<sup>[9]</sup> with the dnsredir<sup>[10]</sup> plugin as a UDP DNS to DoH proxy.

- We configured the behavior of Chrome and Firefox using headless browsers, enabled DoH, and continuously switched between official DoH servers through scripts, collecting normal DoH traffic by accessing popular websites

# References

- [1] tuns https://github.com/lnussbaum/tuns
- [2] tcp-over-dns https://github.com/sunapi386/tcp-over-dns
- [3] dnstt https://github.com/Mygod/dnstt
- [4] godoh https://github.com/sensepost/godoh
- [5] DNSExfiltrator https://github.com/Arno0x/DNSExfiltrator
- [6] DoHlyzer https://github.com/ahlashkari/DOHlyzer
- [7] SafeDoHCapture https://github.com/RongDuJiKsp/SafeDoHCapture
- [8] pcapSpliter https://github.com/RongDuJiKsp/pcapSpliter
- [9] CoreDNS https://github.com/coredns/coredns
- [10] dnsredir https://github.com/leiless/dnsredir
